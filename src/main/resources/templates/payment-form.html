<div th:fragment="fragment">

    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-12 col-md-8 col-lg-6">

                <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
                    <div class="card-header bg-primary text-white text-center py-4">
                        <h2 class="mb-0 fw-bold">
                            <i class="fas fa-credit-card me-2"></i>
                            Thanh Toán Với VNPAY
                        </h2>
                        <p class="mb-0 mt-2 opacity-90">Giao dịch an toàn • Môi trường thử nghiệm (Sandbox)</p>
                    </div>

                    <div class="card-body p-4 p-md-5">
                        <form class="needs-validation" novalidate method="post" th:action="@{/payment/create}">
                            <!-- amount -->
                            <div class="mb-4">
                                <label for="amount" class="form-label fw-semibold text-dark">
                                    <i class="fas fa-money-bill-wave me-1"></i> Số tiền thanh toán (VND)
                                </label>
                                <input type="number"
                                       id="amount"
                                       name="amount"
                                       class="form-control form-control-lg text-end fw-bold"
                                       value="30000000"
                                       min="1000"
                                       step="1000"
                                       placeholder="0"
                                       required
                                       autocomplete="off" />
                                <div class="form-text mt-2 text-muted">
                                    Ví dụ: 30000000 → 30.000.000 ₫
                                </div>
                                <div class="invalid-feedback">
                                    Vui lòng nhập số tiền hợp lệ (tối thiểu 1.000 VND).
                                </div>
                            </div>

                            <!-- orderInfo -->
                            <div class="mb-4">
                                <label for="orderInfo" class="form-label fw-semibold text-dark">
                                    <i class="fas fa-info-circle me-1"></i> Mô tả giao dịch
                                </label>
                                <input type="text"
                                       id="orderInfo"
                                       name="orderInfo"
                                       class="form-control"
                                       value="Thanh toán đơn hàng thuốc"
                                       placeholder="Ví dụ: Thanh toán tiền thuốc tháng 12"
                                       required />
                                <div class="invalid-feedback">
                                    Vui lòng nhập mô tả giao dịch.
                                </div>
                            </div>

                            <!-- promo -->
                            <div class="mb-5">
                                <label for="promoCode" class="form-label fw-semibold text-dark">
                                    <i class="fas fa-tag me-1"></i> Mã khuyến mãi (tùy chọn)
                                </label>
                                <input type="text"
                                       id="promoCode"
                                       name="vnp_PromoCode"
                                       class="form-control"
                                       placeholder="Nhập mã giảm giá nếu có"
                                       autocomplete="off" />
                                <div class="form-text text-muted">
                                    Để trống nếu không sử dụng mã khuyến mãi.
                                </div>
                            </div>

                            <div class="d-grid gap-3">
                                <button type="submit" class="btn btn-danger btn-lg fw-bold py-3 rounded-pill shadow-sm">
                                    <i class="fas fa-arrow-right me-2"></i>
                                    Tiếp Tục Thanh Toán VNPAY
                                </button>

                                <a th:href="@{/}" class="btn btn-outline-secondary btn-lg rounded-pill">
                                    <i class="fas fa-list me-2"></i> Quay lại danh sách giao dịch
                                </a>
                            </div>
                        </form>
                    </div>

                    <div class="card-footer bg-light text-center py-4">
                        <small class="text-muted">
                            <i class="fas fa-lock me-1"></i>
                            Giao dịch được mã hóa và bảo mật bởi VNPAY
                        </small>
                    </div>
                </div>

            </div>
        </div>
    </div>

</div>

<th:block th:fragment="scripts">
    <script>
        // Bootstrap validation
        (function () {
            'use strict'
            const forms = document.querySelectorAll('.needs-validation');
            Array.prototype.slice.call(forms).forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        })();
    </script>
</th:block>
